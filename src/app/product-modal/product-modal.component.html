<form #productForm="ngForm" (ngSubmit)="onSubmit(productForm)">
  <!-- First Name (both modes) -->
  <div class="mb-3" *ngIf="mode === 'quote' || mode === 'order' ||mode==='admin'">
    <input type="text" class="form-control" placeholder="First Name"
           [(ngModel)]="product.firstName" name="firstName" required>
  </div>

  <!-- Phone Number (both modes) -->
<div class="mb-3" *ngIf="mode === 'quote' || mode === 'order' || mode==='admin'">
  <input type="text" 
         class="form-control" 
         placeholder="Phone Number"
         [(ngModel)]="product.phoneNumber"
         name="phoneNumber"
         required
         pattern="^(\+27|0)[6-8][0-9]{2}([ -]?[0-9]{3})([ -]?[0-9]{3})$"
         #phoneNumber="ngModel">

  <div class="text-danger mt-1" *ngIf="phoneNumber.invalid && phoneNumber.touched">
    <div *ngIf="phoneNumber.errors?.['required']">Phone number is required.</div>
    <div *ngIf="phoneNumber.errors?.['pattern']">
      Enter a valid South African phone number (10 digits, optional +27).
    </div>
  </div>
</div>




  <!-- Product Name (only quote) -->
  <div class="mb-3" *ngIf="mode === 'quote' ||mode==='admin'">
    <input type="text" class="form-control" placeholder="Product Name"
           [(ngModel)]="product.name" name="name" required>
  </div>

  <!-- Color (both modes) -->
  <div class="mb-3" *ngIf="mode === 'quote' || mode === 'order' ||mode==='admin'">
    <input type="text" class="form-control" placeholder="Color"
           [(ngModel)]="product.color" name="color" required>
  </div>

  <!-- Description (only quote) -->
  <div class="mb-3" *ngIf="mode === 'quote' ||mode==='admin'">
    <input type="text" class="form-control" placeholder="Description"
           [(ngModel)]="product.description" name="description" required>
  </div>

  <!-- Quantity (both modes) -->
  <div class="mb-3" *ngIf="mode === 'quote' || mode === 'order' ||mode==='admin'">
    <input type="number" class="form-control" placeholder="Quantity"
           [(ngModel)]="product.quantity" name="quantity" required>
  </div>

  <!-- Price (always visible, both modes) -->
 <div class="mb-3" *ngIf="mode === 'admin'">
  <input type="number" class="form-control" placeholder="Price"
         [(ngModel)]="product.price"
         (ngModelChange)="onPriceChange($event)"
         name="price" required>
</div>
   <div class="mb-3" *ngIf="mode==='admin'">
    <input type="number" class="form-control" placeholder="specialOffer"
           [(ngModel)]="product.specialOffer" name="specialOffer" required>
  </div>
  <!-- File upload (only in quote) -->
  <div class="mb-3" *ngIf="mode === 'quote' ||mode==='admin'">
    <input #fileInput type="file" class="form-control" (change)="onFileSelected($event)" accept="image/*">
  </div>

  <!-- Image preview (quote only) -->
  <div class="mb-3" *ngIf="product.image && mode === 'quote' ||mode==='admin'">
    <div class="card shadow-sm" style="max-width: 100px;">
      <img [src]="product.image" class="card-img-top" alt="Preview">
      <div class="card-body p-2">
        <p class="card-text text-center small mb-0">Preview</p>
      </div>
    </div>
  </div>

  <!-- Submit button -->
  <div *ngIf="!isSuccess">
    <button type="submit" class="btn btn-primary w-100" [disabled]="!productForm.valid || isLoading">
      <ng-container *ngIf="isLoading; else notLoading">
        <span class="spinner-border spinner-border-sm me-2"></span>
        Submitting...
      </ng-container>
      <ng-template #notLoading>Submit</ng-template>
    </button>
  </div>

  <!-- Success -->
  <div *ngIf="isSuccess" class="text-center p-3">
    <div class="alert alert-success" role="alert">
      âœ… Request submitted successfully! <br>
      We will get in touch very soon.
    </div>
    <button class="btn btn-dark mt-2" (click)="closeModal()">Close</button>
  </div>
</form>
